(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-294d326e"],{"0b7b":function(o,n,t){},"15d0":function(o,n,t){"use strict";t("0b7b")},ef3e:function(o,n,t){"use strict";t.r(n);var e,a,i,l,r,c,s,u,_,d,h=function(){var o=this,n=o.$createElement,t=o._self._c||n;return t("v-container",{staticClass:"pa-0 ma-0",attrs:{fluid:"",id:"root","fill-height":""}},[t("canvas",{staticClass:"pa-0 ma-0",attrs:{"fill-height":"",id:"map"}}),t("canvas",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{id:"temp"}}),t("v-card",{staticClass:"floating px-2",staticStyle:{"background-color":"rgba(20,20,30,1)"},attrs:{width:"170px",flat:"",rounded:"xl"}},[t("v-card-text",[t("v-row",{staticClass:"pa-2"},[t("v-switch",{attrs:{label:"Manual",color:"purple accent-4",disabled:o.control_loading,loading:o.control_loading,dark:""},on:{change:function(n){return o.manual(n,"love")}},model:{value:o.controllers,callback:function(n){o.controllers=n},expression:"controllers"}})],1)],1),o.controllers?t("v-card-text",[t("v-row",{staticClass:"pa-2"},[t("v-btn",{attrs:{text:"",color:"purple accent-4"},on:{click:o.go_home}},[o._v("go home")]),t("v-switch",{attrs:{label:"Angled Goal",color:"purple accent-4",disabled:o.control_loading,loading:o.control_loading,dark:""},on:{change:function(n){return o.wait_for_goal(n,"angled")}},model:{value:o.angled_goal,callback:function(n){o.angled_goal=n},expression:"angled_goal"}}),t("v-switch",{attrs:{label:"Unangled Goal",color:"purple accent-4",disabled:o.control_loading,loading:o.control_loading,dark:""},on:{change:function(n){return o.wait_for_goal(n,"unangled")}},model:{value:o.unangled_goal,callback:function(n){o.unangled_goal=n},expression:"unangled_goal"}}),t("v-btn",{attrs:{text:"",color:"purple accent-4"},on:{click:o.clear_goal}},[o._v("clear")])],1),t("v-row",{staticClass:"pa-2"},[t("v-spacer"),t("v-switch",{attrs:{label:"arrow control",color:"purple accent-4",dark:""},model:{value:o.cmd_vel,callback:function(n){o.cmd_vel=n},expression:"cmd_vel"}}),t("v-spacer")],1),t("v-row",{staticClass:"pa-2"},[t("v-btn",{attrs:{color:"purple accent-4",fab:"",small:"",icon:""},on:{mousedown:function(n){o.continue_zoomin=!0,o.zoomin(n)},mouseup:function(n){o.continue_zoomin=!1},touchstart:function(n){o.continue_zoomin=!0,o.zoomin(n.touches[0])},touchstop:function(n){o.continue_zoomin=!1}}},[t("v-icon",[o._v(" mdi-plus ")])],1),t("v-spacer"),t("v-btn",{attrs:{color:"purple accent-4",fab:"",small:"",icon:""},on:{mousedown:function(n){o.continue_zoomout=!0,o.zoomout(n)},mouseup:function(n){o.continue_zoomout=!1},touchstart:function(n){o.continue_zoomout=!0,o.zoomout(n.touches[0])},touchstop:function(n){o.continue_zoomout=!1}}},[t("v-icon",[o._v(" mdi-minus ")])],1)],1),t("v-row",{staticClass:"pa-2"},[t("v-spacer"),t("v-btn",{attrs:{color:"purple accent-4",fab:"",small:"",icon:""},on:{mousedown:function(n){o.continue_movement_up=!0,o.up(n)},mouseup:function(n){o.continue_movement_up=!1,o.stop()}}},[t("v-icon",[o._v(" mdi-chevron-up ")])],1),t("v-spacer")],1),t("v-row",{staticClass:"pa-2"},[t("v-btn",{attrs:{color:"purple accent-4",fab:"",small:"",icon:""},on:{mousedown:function(n){o.continue_movement_left=!0,o.left(n)},mouseup:function(n){o.continue_movement_left=!1,o.stop()}}},[t("v-icon",[o._v(" mdi-chevron-left ")])],1),t("v-spacer"),t("v-btn",{attrs:{color:"purple accent-4",fab:"",small:"",icon:""},on:{click:function(n){return o.stop()}}},[t("v-icon",[o._v(" mdi-close-circle-outline ")])],1),t("v-spacer"),t("v-btn",{attrs:{color:"purple accent-4",fab:"",small:"",icon:""},on:{mousedown:function(n){o.continue_movement_right=!0,o.right(n)},mouseup:function(n){o.continue_movement_right=!1,o.stop()}}},[t("v-icon",[o._v(" mdi-chevron-right ")])],1)],1),t("v-row",{staticClass:"pa-2"},[t("v-spacer"),t("v-btn",{attrs:{color:"purple accent-4",fab:"",small:"",icon:""},on:{mousedown:function(n){o.continue_movement_down=!0,o.down(n)},mouseup:function(n){o.continue_movement_down=!1,o.stop()}}},[t("v-icon",[o._v(" mdi-chevron-down ")])],1),t("v-spacer")],1)],1):o._e()],1)],1)},m=[],g=t("1da1"),f=(t("96cf"),t("d3b7"),t("cb29"),t("159b"),t("99af"),t("47e3")),p=t("e86b"),v=t.n(p),w=t("6176"),b=t.n(w),y={},x=2.5,z=0,P=0;function k(o){return new Promise((function(n){return setTimeout(n,o)}))}function M(){return T.apply(this,arguments)}function T(){return T=Object(g["a"])(regeneratorRuntime.mark((function o(){var n,t;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:n=!0;case 1:if(!n){o.next=6;break}return o.next=4,k(1500).then((function(){t=new v.a.Ros({url:"ws://".concat(f["a"].bridge_address,":9090")}),t.on("connection",(function(){n=!1})),t.on("error",(function(){console.error("error connecting to rosbridge")}))}));case 4:o.next=1;break;case 6:return o.abrupt("return",new Promise((function(o){return o(t)})));case 7:case"end":return o.stop()}}),o)}))),T.apply(this,arguments)}function I(o){var n={};Object.assign(n,o),l.width=n.info.width,l.height=n.info.height,_=i.createImageData(n.info.width,n.info.height);for(var t=n.info.height-1;t>-1;t--)for(var e=n.info.width-1;e>-1;e--){var a,r=e+t*n.info.width,c=n.data[r];a=100===c?0:0===c?255:127;var s=4*(n.info.width-e+t*n.info.width);_.data[s]=a,_.data[++s]=a,_.data[++s]=a,_.data[++s]=255}}function Y(){i.moveTo(0,0),i.beginPath(),i.rect(0,0,a.width,a.height),i.fillStyle="rgb(127,127,127)",i.fill(),i.closePath()}function C(o){var n=o.w,t=o.x,e=o.y,a=o.z;return-Math.atan2(2*(n*a+t*e),1-2*(e*e+a*a))}function E(o,n,t){var e=u.info.width-(o-u.info.origin.position.x)/u.info.resolution,a=(n-u.info.origin.position.y)/u.info.resolution,i=null;return t&&(i=C(t),i<0&&(i=2*Math.PI+i)),{x:e,y:a,theta:i}}function X(){if(d){var o=7,n=E(d.position.x,d.position.y,d.orientation),t=n.x,e=n.y,a=n.theta+Math.PI,i=a+Math.PI/6,l=a-Math.PI/6;i=i>2*Math.PI?i-2*Math.PI:i<0?i+2*Math.PI:i,l=l>2*Math.PI?l-2*Math.PI:l<0?l+2*Math.PI:l,r.beginPath(),r.moveTo(t,e),r.arc(t,e,o,i,l),r.fillStyle="purple",r.fill(),r.closePath()}}var R={};function L(o,n,t,e){var a=E(o,n);r.beginPath(),r.moveTo(a.x,a.y),r.arc(a.x,a.y,e,0,2*Math.PI),r.fillStyle=t,r.fill(),r.closePath()}function V(o,n,t,e){var a=E(o,n),i=20*Math.cos(t)+a.x,l=-20*Math.sin(t)+a.y;r.beginPath(),r.moveTo(a.x,a.y),r.lineTo(i,l),r.strokeStyle=e,r.lineWidth=2,r.stroke(),r.closePath()}function S(){y.poses&&y.poses.length>0&&y.poses.forEach((function(o){L(o.pose.position.x,o.pose.position.y,"blue",1)}))}function $(){if(R.draw&&s){var o="blue";if(!(R.robot_x-s["pose"]["x"]<.15&&R.robot_y-s["pose"]["y"]<.15))return void console.log("returning");"succeed"==s.state?o="green":"running"==s.state?(S(),o="orange"):"false"==s.state&&(o="red"),s.is_angled?V(R.robot_x,R.robot_y,R.angle,o):L(R.robot_x,R.robot_y,o,2)}}function B(){_&&(r.beginPath(),r.moveTo(0,0),r.putImageData(_,0,0),r.closePath(),X(),$(),i.drawImage(l,z,P,a.width/x>>0,a.height/x>>0,0,0,a.width,a.height),i.closePath())}function O(){return j.apply(this,arguments)}function j(){return j=Object(g["a"])(regeneratorRuntime.mark((function o(){return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return Y(),B(),o.next=4,k(100);case 4:requestAnimationFrame(O);case 5:case"end":return o.stop()}}),o)}))),j.apply(this,arguments)}var D={data:function(){return{cmd_vel:!1,unangled_goal_pub:null,continue_movement_left:!1,continue_movement_up:!1,continue_movement_right:!1,continue_movement_down:!1,continue_zoomout:!1,continue_zoomin:!1,canvas:null,temp_canvas:null,c:null,temp_c:null,control_loading:!1,go_home_model:!1,controllers:!1,angled_goal:!1,unangled_goal:!1}},methods:{down:function(){this.continue_movement_down&&(this.cmd_vel?this.cmd_vel_down():this.movedown(),setTimeout(this.down,60))},up:function(){this.continue_movement_up&&(this.cmd_vel?this.cmd_vel_up():this.moveup(),setTimeout(this.up,60))},right:function(){this.continue_movement_right&&(this.cmd_vel?this.cmd_vel_right():this.moveright(),setTimeout(this.right,60))},left:function(){this.continue_movement_left&&(this.cmd_vel?this.cmd_vel_left():this.moveleft(),setTimeout(this.left,60))},cmd_vel_right:function(){var o=new v.a.Message({linear:{x:0,y:0,z:0},angular:{x:0,y:0,z:-1}});this.cmd_vel_pub.publish(o)},cmd_vel_left:function(){var o=new v.a.Message({linear:{x:0,y:0,z:0},angular:{x:0,y:0,z:1}});this.cmd_vel_pub.publish(o)},cmd_vel_up:function(){var o=new v.a.Message({linear:{x:.24,y:0,z:0},angular:{x:0,y:0,z:0}});this.cmd_vel_pub.publish(o)},cmd_vel_down:function(){var o=new v.a.Message({linear:{x:-.24,y:0,z:0},angular:{x:0,y:0,z:0}});this.cmd_vel_pub.publish(o)},stop:function(){var o=new v.a.Message({linear:{x:0,y:0,z:0},angular:{x:0,y:0,z:0}});this.cmd_vel_pub.publish(o)},zoomin:function(o){console.log(o),this.continue_zoomin&&(x<2.5?x+=.1:this.continue_zoomin=!1,setTimeout(this.zoomin,60))},zoomout:function(){this.continue_zoomout&&(x>.5?x-=.1:this.continue_zoomout=!1,setTimeout(this.zoomout,60))},moveup:function(){P>-.1*a.height?P-=10:this.continue_movement_up=!1},movedown:function(){P+a.height/x<1.1*a.height?P+=10:this.continue_movement_down=!1},moveright:function(){z+a.width/x<1.1*a.width?z+=10:this.continue_movement_right=!1},moveleft:function(){z>-.1*a.width?z-=10:this.continue_movement_left=!1},wait_for_goal:function(o,n){o?"angled"==n?(this.cancel_goal(),this.wait_for_angled_goal()):(this.cancel_goal(),this.wait_for_unangled_goal()):(console.log(o),this.cancel_goal())},wait_for_angled_goal:function(){this.angled_goal=!0,a.addEventListener("mousedown",this.angled_goal_mousedown_handler),a.addEventListener("mouseup",this.angled_goal_mouseup_handler)},wait_for_unangled_goal:function(){this.unangled_goal=!0,a.addEventListener("mousedown",this.unangled_goal_mousedown_handler),a.addEventListener("mouseup",this.unangled_goal_mouseup_handler)},angled_goal_mousedown_handler:function(o){var n=i.getImageData(o.layerX,o.layerY,1,1).data;n[0],n[1],255==n[2]&&(R={},R.x=o.layerX/x+z,R.layerX=o.layerX,R.y=o.layerY/x+P,R.layerY=o.layerY,R.drop=!0,R.draw=!1)},angled_goal_mouseup_handler:function(o){if(R.drop&&u.info){R.drop=!1,R.abs_angle=Math.atan(Math.abs((o.layerY-R.layerY)/(o.layerX-R.layerX))),R.end_layerX=o.layerX,R.end_layerY=o.layerY,R.end_layerX-R.layerX>0?R.end_layerY-R.layerY>0?R.angle=2*Math.PI-R.abs_angle:R.angle=R.abs_angle:R.end_layerY-R.layerY>0?R.angle=Math.PI+R.abs_angle:R.angle=Math.PI-R.abs_angle,R.robot_angle=Math.PI+R.angle,R.robot_angle>2*Math.PI&&(R.robot_angle=-2*Math.PI+R.robot_angle),R.robot_x=(u.info.width-R.x)*u.info.resolution+u.info.origin.position.x,R.robot_y=R.y*u.info.resolution+u.info.origin.position.y;var n=b.a.fromEuler(0,0,R.robot_angle,"XYZ");this.$store.dispatch("Ros/take_action","navigation/angled_goal/".concat(R.robot_x,"&").concat(R.robot_y,"&",0,"&").concat(n.x,"&").concat(n.y,"&").concat(n.z,"&").concat(n.w)).then((function(o){console.log(o),R.draw=!0}))}},unangled_goal_mousedown_handler:function(o){var n=i.getImageData(o.layerX,o.layerY,1,1).data;n[0],n[1],255==n[2]&&(R={},R.x=o.layerX/x+z,R.layerX=o.layerX,R.y=o.layerY/x+P,R.layerY=o.layerY,R.drop=!0,R.draw=!1)},unangled_goal_mouseup_handler:function(){R.drop&&u.info&&(R.drop=!1,R.robot_x=(u.info.width-R.x)*u.info.resolution+u.info.origin.position.x,R.robot_y=R.y*u.info.resolution+u.info.origin.position.y,this.$store.dispatch("Ros/take_action","navigation/unangled_goal/".concat(R.robot_x,"&").concat(R.robot_y)).then((function(o){console.log(o),R.draw=!0})))},clear_goal:function(){R={}},cancel_goal:function(){console.log("clearing event listener"),this.angled_goal=!1,this.unangled_goal=!1,a.removeEventListener("mousedown",this.angled_goal_mousedown_handler),a.removeEventListener("mouseup",this.angled_goal_mouseup_handler),a.removeEventListener("mousedown",this.unangled_goal_mousedown_handler),a.removeEventListener("mouseup",this.unangled_goal_mouseup_handler)},go_home:function(){var o=this;this.$store.dispatch("Ros/take_action","navigation/go_home").then((function(){o.clear_goal()})).catch((function(){}))},manual:function(o,n){var t=this;console.log(o,n),this.control_loading=!0,this.controllers?(this.controllers=!1,this.$store.dispatch("Ros/take_action","global_actions/switch_mode/mnl").then((function(){t.clear_goal(),setTimeout((function(){t.control_loading=!1}),100)})).catch((function(){setTimeout((function(){t.control_loading=!1}),100)}))):(this.controllers=!0,this.$store.dispatch("Ros/take_action","global_actions/switch_mode/mnlcancel").then((function(){t.clear_goal(),setTimeout((function(){t.control_loading=!1}),100)})).catch((function(){setTimeout((function(){t.control_loading=!1}),100)})))}},watch:{mode:function(o){this.controllers=!1,"mnl"==o&&(this.controllers=!0)}},mounted:function(){"sth"==this.mode?this.go_home_model=!0:"mnl"==this.mode&&(this.controllers=!0),this.canvas=a=document.getElementById("map"),this.temp_canvas=l=document.getElementById("temp"),this.c=i=a.getContext("2d"),this.temp_c=r=l.getContext("2d"),setTimeout((function(){M().then((function(o){var n=new v.a.Topic({ros:o,name:"/current_pose",messageType:"geometry_msgs/Pose"});n.subscribe((function(o){d=o}));var t=new v.a.Topic({ros:o,name:"/slamware_ros_sdk_server_node/global_plan_path",messageType:"nav_msgs/Path"});t.subscribe((function(o){y=o}));var e=new v.a.Topic({ros:o,name:"/slamware_ros_sdk_server_node/map",messageType:"nav_msgs/OccupancyGrid",compression:"png"});e.subscribe((function(o){u=o,I(o)}));var a=new v.a.Topic({ros:o,name:"/navigation/goal_monitor",messageType:"status_msgs/goal_monitor_msg"});a.subscribe((function(o){s=o}))}))}),10),e=document.getElementById("root"),c=document.getElementById("mainbar"),a.width=e.offsetWidth,a.height=window.innerHeight-c.offsetHeight,window.onresize=function(){setTimeout((function(){a.width=e.offsetWidth,a.height=window.innerHeight-c.offsetHeight}),10)},O()},computed:{mode:function(){return this.$store.getters["Ros/mode"]}}},H=D,G=(t("15d0"),t("2877")),W=t("6544"),A=t.n(W),J=t("8336"),q=t("b0af"),F=t("99d9"),N=t("a523"),U=t("132d"),Z=t("0fd9"),K=t("2fa4"),Q=t("b73d"),oo=Object(G["a"])(H,h,m,!1,null,"3120fc26",null);n["default"]=oo.exports;A()(oo,{VBtn:J["a"],VCard:q["a"],VCardText:F["b"],VContainer:N["a"],VIcon:U["a"],VRow:Z["a"],VSpacer:K["a"],VSwitch:Q["a"]})}}]);
//# sourceMappingURL=chunk-294d326e.01f0f673.js.map