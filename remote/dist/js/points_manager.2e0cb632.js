(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["points_manager"],{"169a":function(t,n,e){"use strict";var o=e("5530"),i=e("2909"),a=e("ade3"),s=(e("a9e3"),e("498a"),e("caad"),e("2532"),e("7db0"),e("368e"),e("480e")),c=e("4ad4"),r=e("b848"),l=e("75eb"),u=e("e707"),h=e("e4d3"),d=e("21be"),m=e("f2e7"),v=e("a293"),f=e("58df"),p=e("d9bd"),g=e("80d2"),_=Object(f["a"])(c["a"],r["a"],l["a"],u["a"],h["a"],d["a"],m["a"]);n["a"]=_.extend({name:"v-dialog",directives:{ClickOutside:v["a"]},props:{dark:Boolean,disabled:Boolean,fullscreen:Boolean,light:Boolean,maxWidth:{type:[String,Number],default:"none"},noClickAnimation:Boolean,origin:{type:String,default:"center center"},persistent:Boolean,retainFocus:{type:Boolean,default:!0},scrollable:Boolean,transition:{type:[String,Boolean],default:"dialog-transition"},width:{type:[String,Number],default:"auto"}},data:function(){return{activatedBy:null,animate:!1,animateTimeout:-1,isActive:!!this.value,stackMinZIndex:200,previousActiveElement:null}},computed:{classes:function(){var t;return t={},Object(a["a"])(t,"v-dialog ".concat(this.contentClass).trim(),!0),Object(a["a"])(t,"v-dialog--active",this.isActive),Object(a["a"])(t,"v-dialog--persistent",this.persistent),Object(a["a"])(t,"v-dialog--fullscreen",this.fullscreen),Object(a["a"])(t,"v-dialog--scrollable",this.scrollable),Object(a["a"])(t,"v-dialog--animated",this.animate),t},contentClasses:function(){return{"v-dialog__content":!0,"v-dialog__content--active":this.isActive}},hasActivator:function(){return Boolean(!!this.$slots.activator||!!this.$scopedSlots.activator)}},watch:{isActive:function(t){var n;t?(this.show(),this.hideScroll()):(this.removeOverlay(),this.unbind(),null==(n=this.previousActiveElement)||n.focus())},fullscreen:function(t){this.isActive&&(t?(this.hideScroll(),this.removeOverlay(!1)):(this.showScroll(),this.genOverlay()))}},created:function(){this.$attrs.hasOwnProperty("full-width")&&Object(p["e"])("full-width",this)},beforeMount:function(){var t=this;this.$nextTick((function(){t.isBooted=t.isActive,t.isActive&&t.show()}))},beforeDestroy:function(){"undefined"!==typeof window&&this.unbind()},methods:{animateClick:function(){var t=this;this.animate=!1,this.$nextTick((function(){t.animate=!0,window.clearTimeout(t.animateTimeout),t.animateTimeout=window.setTimeout((function(){return t.animate=!1}),150)}))},closeConditional:function(t){var n=t.target;return!(this._isDestroyed||!this.isActive||this.$refs.content.contains(n)||this.overlay&&n&&!this.overlay.$el.contains(n))&&this.activeZIndex>=this.getMaxZIndex()},hideScroll:function(){this.fullscreen?document.documentElement.classList.add("overflow-y-hidden"):u["a"].options.methods.hideScroll.call(this)},show:function(){var t=this;!this.fullscreen&&!this.hideOverlay&&this.genOverlay(),this.$nextTick((function(){t.$nextTick((function(){t.previousActiveElement=document.activeElement,t.$refs.content.focus(),t.bind()}))}))},bind:function(){window.addEventListener("focusin",this.onFocusin)},unbind:function(){window.removeEventListener("focusin",this.onFocusin)},onClickOutside:function(t){this.$emit("click:outside",t),this.persistent?this.noClickAnimation||this.animateClick():this.isActive=!1},onKeydown:function(t){if(t.keyCode===g["y"].esc&&!this.getOpenDependents().length)if(this.persistent)this.noClickAnimation||this.animateClick();else{this.isActive=!1;var n=this.getActivator();this.$nextTick((function(){return n&&n.focus()}))}this.$emit("keydown",t)},onFocusin:function(t){if(t&&this.retainFocus){var n=t.target;if(n&&![document,this.$refs.content].includes(n)&&!this.$refs.content.contains(n)&&this.activeZIndex>=this.getMaxZIndex()&&!this.getOpenDependentElements().some((function(t){return t.contains(n)}))){var e=this.$refs.content.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),o=Object(i["a"])(e).find((function(t){return!t.hasAttribute("disabled")}));o&&o.focus()}}},genContent:function(){var t=this;return this.showLazyContent((function(){return[t.$createElement(s["a"],{props:{root:!0,light:t.light,dark:t.dark}},[t.$createElement("div",{class:t.contentClasses,attrs:Object(o["a"])({role:"document",tabindex:t.isActive?0:void 0},t.getScopeIdAttrs()),on:{keydown:t.onKeydown},style:{zIndex:t.activeZIndex},ref:"content"},[t.genTransition()])])]}))},genTransition:function(){var t=this.genInnerContent();return this.transition?this.$createElement("transition",{props:{name:this.transition,origin:this.origin,appear:!0}},[t]):t},genInnerContent:function(){var t={class:this.classes,ref:"dialog",directives:[{name:"click-outside",value:{handler:this.onClickOutside,closeConditional:this.closeConditional,include:this.getOpenDependentElements}},{name:"show",value:this.isActive}],style:{transformOrigin:this.origin}};return this.fullscreen||(t.style=Object(o["a"])(Object(o["a"])({},t.style),{},{maxWidth:"none"===this.maxWidth?void 0:Object(g["g"])(this.maxWidth),width:"auto"===this.width?void 0:Object(g["g"])(this.width)})),this.$createElement("div",t,this.getContentSlot())}},render:function(t){return t("div",{staticClass:"v-dialog__container",class:{"v-dialog__container--attached":""===this.attach||!0===this.attach||"attach"===this.attach},attrs:{role:"dialog"}},[this.genActivator(),this.genContent()])}})},"368e":function(t,n,e){},"661a":function(t,n,e){"use strict";e("7fae")},7487:function(t,n,e){"use strict";e.r(n);var o,i,a,s,c,r,l,u,h,d,m=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("v-container",{staticClass:"pa-0 ma-0",attrs:{fluid:"",id:"root","fill-height":""}},[e("v-dialog",{attrs:{"max-width":"400px",persistent:""},model:{value:t.save_point_dialog,callback:function(n){t.save_point_dialog=n},expression:"save_point_dialog"}},[e("v-card",{staticClass:"mx-auto pa-4",attrs:{"max-width":"400",outlined:"",dark:"",color:""}},[e("v-card-text",{staticClass:"text-h5 font-weight-bold"},[e("v-text-field",{attrs:{type:"text",label:"Point Name"},model:{value:t.point_name,callback:function(n){t.point_name=n},expression:"point_name"}})],1),e("v-card-actions",[e("v-btn",{attrs:{color:"#ffc74a",light:""},on:{click:function(n){return t.save_point()}}},[t._v(" save ")]),e("v-spacer"),e("v-btn",{attrs:{color:"#ffc74a",light:""},on:{click:function(n){t.save_point_dialog=!1}}},[t._v(" cancel ")])],1)],1)],1),e("v-dialog",{model:{value:t.manage_points_dialog,callback:function(n){t.manage_points_dialog=n},expression:"manage_points_dialog"}},[e("v-card",{staticClass:"mx-auto pa-4",attrs:{outlined:"",dark:"",color:""}},[t.points.show?e("v-card-text",{staticClass:"text-h5 font-weight-bold"},[e("v-data-table",{staticClass:"elevation-1",attrs:{headers:t.points.headers,items:t.points.data},scopedSlots:t._u([{key:"item.actions",fn:function(n){var o=n.item;return[e("v-icon",{staticClass:"mr-2",attrs:{small:""},on:{click:function(n){return t.del_point(o.name)}}},[t._v(" mdi-delete ")])]}}],null,!1,2145483221)})],1):e("v-card-text",{staticClass:"text-h5 font-weight-bold"},[t._v(" Sorry No Point Available ")])],1)],1),e("canvas",{staticClass:"pa-0 ma-0",attrs:{"fill-height":"",id:"map"}}),e("canvas",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{id:"temp"}}),e("v-card",{staticClass:"floating px-2",staticStyle:{"background-color":"rgba(20,20,30,1)"},attrs:{width:"170px",flat:"",rounded:"xl"}},[e("v-card-text",[e("v-row",{staticClass:"pa-2"},[e("v-btn",{attrs:{text:"",color:"purple accent-4"},on:{click:t.open_save_point_dialog}},[t._v("save point")]),e("v-btn",{attrs:{text:"",color:"purple accent-4"},on:{click:t.open_manage_points_dialog}},[t._v("manage points")])],1),e("v-row",{staticClass:"pa-2"},[e("v-btn",{attrs:{color:"purple accent-4",fab:"",small:"",icon:""},on:{mousedown:function(n){t.continue_zoomin=!0,t.zoomin(n)},mouseup:function(n){t.continue_zoomin=!1}}},[e("v-icon",[t._v(" mdi-plus ")])],1),e("v-spacer"),e("v-btn",{attrs:{color:"purple accent-4",fab:"",small:"",icon:""},on:{mousedown:function(n){t.continue_zoomout=!0,t.zoomout(n)},mouseup:function(n){t.continue_zoomout=!1}}},[e("v-icon",[t._v(" mdi-minus ")])],1)],1),e("v-row",{staticClass:"pa-2"},[e("v-spacer"),e("v-btn",{attrs:{color:"purple accent-4",fab:"",small:"",icon:""},on:{mousedown:function(n){t.continue_movement_up=!0,t.up(n)},mouseup:function(n){t.continue_movement_up=!1}}},[e("v-icon",[t._v(" mdi-chevron-up ")])],1),e("v-spacer")],1),e("v-row",{staticClass:"pa-2"},[e("v-btn",{attrs:{color:"purple accent-4",fab:"",small:"",icon:""},on:{mousedown:function(n){t.continue_movement_left=!0,t.left(n)},mouseup:function(n){t.continue_movement_left=!1}}},[e("v-icon",[t._v(" mdi-chevron-left ")])],1),e("v-spacer"),e("v-btn",{attrs:{color:"purple accent-4",small:"",icon:""},on:{"":function(t){}}},[e("v-icon",[t._v(" mdi-close-circle-outline ")])],1),e("v-spacer"),e("v-btn",{attrs:{color:"purple accent-4",fab:"",small:"",icon:""},on:{mousedown:function(n){t.continue_movement_right=!0,t.right(n)},mouseup:function(n){t.continue_movement_right=!1}}},[e("v-icon",[t._v(" mdi-chevron-right ")])],1)],1),e("v-row",{staticClass:"pa-2"},[e("v-spacer"),e("v-btn",{attrs:{color:"purple accent-4",fab:"",small:"",icon:""},on:{mousedown:function(n){t.continue_movement_down=!0,t.down(n)},mouseup:function(n){t.continue_movement_down=!1}}},[e("v-icon",[t._v(" mdi-chevron-down ")])],1),e("v-spacer")],1)],1)],1)],1)},v=[],f=e("1da1"),p=(e("96cf"),e("d3b7"),e("cb29"),e("159b"),e("fb6a"),e("ac1f"),e("1276"),e("99af"),e("47e3")),g=e("e86b"),_=e.n(g),w={},b=2,x=0,y=0;function k(t){return new Promise((function(n){return setTimeout(n,t)}))}function C(){return T.apply(this,arguments)}function T(){return T=Object(f["a"])(regeneratorRuntime.mark((function t(){var n,e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:n=!0;case 1:if(!n){t.next=6;break}return t.next=4,k(1500).then((function(){e=new _.a.Ros({url:"ws://".concat(p["a"].bridge_address,":9090")}),e.on("connection",(function(){n=!1})),e.on("error",(function(){console.error("error connecting to rosbridge")}))}));case 4:t.next=1;break;case 6:return t.abrupt("return",new Promise((function(t){return t(e)})));case 7:case"end":return t.stop()}}),t)}))),T.apply(this,arguments)}function I(t){var n={};Object.assign(n,t),s.width=n.info.width,s.height=n.info.height,h=a.createImageData(n.info.width,n.info.height);for(var e=n.info.height-1;e>-1;e--)for(var o=n.info.width-1;o>-1;o--){var i,c=o+e*n.info.width,r=n.data[c];i=100===r?0:0===r?255:127;var l=4*(n.info.width-o+e*n.info.width);h.data[l]=i,h.data[++l]=i,h.data[++l]=i,h.data[++l]=255}}function O(){a.moveTo(0,0),a.beginPath(),a.rect(0,0,i.width,i.height),a.fillStyle="rgb(127,127,127)",a.fill(),a.closePath()}function P(t){var n=t.w,e=t.x,o=t.y,i=t.z;return-Math.atan2(2*(n*i+e*o),1-2*(o*o+i*i))}function A(t,n,e){var o=u.info.width-(t-u.info.origin.position.x)/u.info.resolution,i=(n-u.info.origin.position.y)/u.info.resolution,a=null;return e&&(a=P(e),a<0&&(a=2*Math.PI+a)),{x:o,y:i,theta:a}}function $(){if(d){var t=7,n=A(d.position.x,d.position.y,d.orientation),e=n.x,o=n.y,i=n.theta+Math.PI,a=i+Math.PI/6,s=i-Math.PI/6;a=a>2*Math.PI?a-2*Math.PI:a<0?a+2*Math.PI:a,s=s>2*Math.PI?s-2*Math.PI:s<0?s+2*Math.PI:s,c.beginPath(),c.moveTo(e,o),c.arc(e,o,t,a,s),c.fillStyle="purple",c.fill(),c.closePath()}}var E={};function S(t,n,e,o){var i=A(t,n);c.beginPath(),c.moveTo(i.x,i.y),c.arc(i.x,i.y,o,0,2*Math.PI),c.fillStyle=e,c.fill(),c.closePath()}function z(t,n,e,o){var i=A(t,n),a=20*Math.cos(e)+i.x,s=-20*Math.sin(e)+i.y;c.beginPath(),c.moveTo(i.x,i.y),c.lineTo(a,s),c.strokeStyle=o,c.lineWidth=2,c.stroke(),c.closePath()}function j(){w.poses&&w.poses.length>0&&w.poses.forEach((function(t){S(t.pose.position.x,t.pose.position.y,"blue",1)}))}function M(){if(E.draw&&l){var t="blue";if(!(E.robot_x-l["pose"]["x"]<.15&&E.robot_y-l["pose"]["y"]<.15))return void console.log("returning");"succeed"==l.state?t="green":"running"==l.state?(j(),t="orange"):"false"==l.state&&(t="red"),l.is_angled?z(E.robot_x,E.robot_y,E.angle,t):S(E.robot_x,E.robot_y,t,2)}}function B(){h&&(c.beginPath(),c.moveTo(0,0),c.putImageData(h,0,0),c.closePath(),$(),M(),a.drawImage(s,x,y,i.width/b>>0,i.height/b>>0,0,0,i.width,i.height),a.closePath())}function F(){return D.apply(this,arguments)}function D(){return D=Object(f["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return O(),B(),t.next=4,k(100);case 4:requestAnimationFrame(F);case 5:case"end":return t.stop()}}),t)}))),D.apply(this,arguments)}var R={data:function(){return{unangled_goal_pub:null,continue_movement_left:!1,continue_movement_up:!1,continue_movement_right:!1,continue_movement_down:!1,continue_zoomout:!1,continue_zoomin:!1,canvas:null,temp_canvas:null,c:null,temp_c:null,save_point_dialog:!1,point_name:"",manage_points_dialog:!1,points:{headers:[{text:"Name",value:"name",sortable:!1,align:"start"},{text:"X",value:"x"},{text:"Y",value:"y"},{text:"Delete",value:"actions",sortable:!1}],show:!1,data:null,alternative:"Please Scan To Show Nearbye Devices"}}},methods:{open_manage_points_dialog:function(){var t=this;this.$store.dispatch("Ros/take_action","navigation/fetch_points",{root:!0}).then((function(n){""==n?(t.points.show=!1,console.log("love")):(n=n.split("|").slice(1),t.points.data=[],n.forEach((function(n){n=n.split("&"),t.points.data.push({name:n[0],x:n[1],y:n[2]})})),t.manage_points_dialog=!0,t.points.show=!0,console.log(n))}))},save_point:function(){E.robot_x&&E.robot_y&&this.point_name&&(this.$store.dispatch("Ros/take_action","navigation/add_point/".concat(this.point_name,"/").concat(E.robot_x,"/").concat(E.robot_y),{root:!0}),this.save_point_dialog=!1)},del_point:function(t){var n=this;console.log(t),this.$store.dispatch("Ros/take_action","navigation/del_point/".concat(t),{root:!0}).then((function(){n.$store.dispatch("Ros/take_action","navigation/fetch_points",{root:!0}).then((function(t){""==t?(n.points.show=!1,console.log("love")):(t=t.split("|").slice(1),n.points.data=[],t.forEach((function(t){t=t.split("&"),n.points.data.push({name:t[0],x:t[1],y:t[2]})})),n.manage_points_dialog=!0,n.points.show=!0,console.log(t))}))}))},open_save_point_dialog:function(){if(E.draw&&l){if(!(E.robot_x-l["pose"]["x"]<.15&&E.robot_y-l["pose"]["y"]<.15))return console.log("returning"),void alert("invalid point");"succeed"==l.state&&(this.point_name="",this.save_point_dialog=!0)}},down:function(){this.continue_movement_down&&(this.movedown(),setTimeout(this.down,60))},up:function(){this.continue_movement_up&&(this.moveup(),setTimeout(this.up,60))},right:function(){this.continue_movement_right&&(this.moveright(),setTimeout(this.right,60))},left:function(){this.continue_movement_left&&(this.moveleft(),setTimeout(this.left,60))},zoomin:function(){this.continue_zoomin&&(b<2.5?b+=.1:this.continue_zoomin=!1,setTimeout(this.zoomin,60))},zoomout:function(){this.continue_zoomout&&(b>.5?b-=.1:this.continue_zoomout=!1,setTimeout(this.zoomout,60))},moveup:function(){y>-.1*i.height?y-=10:this.continue_movement_up=!1},movedown:function(){y+i.height/b<1.1*i.height?y+=10:this.continue_movement_down=!1},moveright:function(){x+i.width/b<1.1*i.width?x+=10:this.continue_movement_right=!1},moveleft:function(){x>-.1*i.width?x-=10:this.continue_movement_left=!1},unangled_goal_mousedown_handler:function(t){var n=a.getImageData(t.layerX,t.layerY,1,1).data;n[0],n[1],255==n[2]&&(E={},E.x=t.layerX/b+x,E.layerX=t.layerX,E.y=t.layerY/b+y,E.layerY=t.layerY,E.drop=!0,E.draw=!1)},unangled_goal_mouseup_handler:function(){E.drop&&u.info&&(E.drop=!1,E.robot_x=(u.info.width-E.x)*u.info.resolution+u.info.origin.position.x,E.robot_y=E.y*u.info.resolution+u.info.origin.position.y,this.$store.dispatch("Ros/take_action","navigation/unangled_goal/".concat(E.robot_x,"&").concat(E.robot_y)).then((function(t){console.log(t),E.draw=!0})))}},watch:{},mounted:function(){var t=this;this.canvas=i=document.getElementById("map"),this.temp_canvas=s=document.getElementById("temp"),o=document.getElementById("root"),r=document.getElementById("mainbar"),i.width=o.offsetWidth,i.height=window.innerHeight-r.offsetHeight,this.c=a=i.getContext("2d"),this.temp_c=c=s.getContext("2d"),setInterval((function(){t.$store.dispatch("Ros/take_action","navigation/get_current_pose",{root:!0}).then((function(t){d={},t=t.split("&"),d.position={},d.position.x=parseFloat(t[0]),d.position.y=parseFloat(t[1]),d.position.z=parseFloat(t[2]),d.orientation={},d.orientation.x=parseFloat(t[3]),d.orientation.y=parseFloat(t[4]),d.orientation.z=parseFloat(t[5]),d.orientation.w=parseFloat(t[6])}))}),50),setTimeout((function(){C().then((function(t){var n=new _.a.Topic({ros:t,name:"/slamware_ros_sdk_server_node/global_plan_path",messageType:"nav_msgs/Path"});n.subscribe((function(t){w=t}));var e=new _.a.Topic({ros:t,name:"/slamware_ros_sdk_server_node/map",messageType:"nav_msgs/OccupancyGrid",compression:"png"});e.subscribe((function(t){u=t,I(t)}));var o=new _.a.Topic({ros:t,name:"/navigation/goal_monitor",messageType:"status_msgs/goal_monitor_msg"});o.subscribe((function(t){l=t}))}))}),10),window.onresize=function(){setTimeout((function(){i.width=o.offsetWidth,i.height=window.innerHeight-r.offsetHeight}),10)},F(),i.addEventListener("mousedown",this.unangled_goal_mousedown_handler),i.addEventListener("mouseup",this.unangled_goal_mouseup_handler)},beforeDestroy:function(){clearInterval(this.navigation_mode_interval_holder)},computed:{}},V=R,N=(e("661a"),e("2877")),W=e("6544"),L=e.n(W),Z=e("8336"),X=e("b0af"),Y=e("99d9"),H=e("a523"),q=e("8fea"),J=e("169a"),K=e("132d"),G=e("0fd9"),Q=e("2fa4"),U=e("8654"),tt=Object(N["a"])(V,m,v,!1,null,"29a5c28a",null);n["default"]=tt.exports;L()(tt,{VBtn:Z["a"],VCard:X["a"],VCardActions:Y["a"],VCardText:Y["b"],VContainer:H["a"],VDataTable:q["a"],VDialog:J["a"],VIcon:K["a"],VRow:G["a"],VSpacer:Q["a"],VTextField:U["a"]})},"7fae":function(t,n,e){}}]);
//# sourceMappingURL=points_manager.2e0cb632.js.map